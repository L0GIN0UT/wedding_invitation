#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞ –≥–æ—Å—Ç–µ–π –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î
set -e

echo "üîÑ –ó–∞–ø—É—Å–∫ –∏–º–ø–æ—Ä—Ç–∞ –≥–æ—Å—Ç–µ–π –∏–∑ JSON..."

# –ñ–¥–µ–º –ø–æ–∫–∞ PostgreSQL –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ —á–µ—Ä–µ–∑ Unix socket
until pg_isready -h /var/run/postgresql -U "$POSTGRES_USER" -d "$POSTGRES_DB" 2>/dev/null; do
  sleep 1
done

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–∞—É–∑–∞ –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
sleep 1

# –ó–∞–ø—É—Å–∫–∞–µ–º Python —Å–∫—Ä–∏–ø—Ç –∏–º–ø–æ—Ä—Ç–∞ –∏–∑ /app
cd /app
python3 scripts/import_guests.py

echo "‚úÖ –ò–º–ø–æ—Ä—Ç –≥–æ—Å—Ç–µ–π –∑–∞–≤–µ—Ä—à–µ–Ω"

